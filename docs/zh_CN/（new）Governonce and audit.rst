治理与审计
=========

多级权限管理
-----------

联盟链的准入机制虽然能一定程度上保障安全性，但缺乏针对不同角色的细粒度的权限管理。因此，为了支撑更丰富复杂的商业应用场景需求，平台建立了多层级权限管理体系，进一步保障商业隐私和安全。

目前，平台设有系统管理员、审计管理员、节点管理员、合约操作员以及用户五个主要账户角色：

- 系统管理员 ：参与区块链级别的权限管理，包括节点管理、系统升级、合约升级的权限控制，往往是各联盟机构指定的内部超级管理员。节点准入、系统升级、合约升级这种链级别的操作权限需由联盟各机构投票决定，而不仅仅是单一主体可以主导的。具体的投票规则由各联盟机构线下协商好，并写入Genesis区块。后续若要更改需按照之前约定的规则进行一轮投票才能完成更改。链级权限管理需要借助上面提到的自治联盟组织（CAF）。
- 审计管理员 ：负责合规性监管，审计区块链上的数据。
- 节点管理员 ：参与节点级别的权限管理，包括节点访问权限的控制，往往是各联盟机构指定的运维管理员。由其给各用户颁发访问证书（SDKCert），控制用户访问SDK接口的权限，带有节点访问证书的请求才会被该节点受理。节点管理员可通过客户端颁发证书，配置用户权限表，分配用户访问SDK的权限，比如访问调用合约的权限、获取区块权限等。链级管理员默认带有节点访问证书SDKCert。
- 合约操作员 ：平台设置了合约访问控制，合约编码者可以在合约中定制合约函数的访问权限。合约编码者可以在合约中为一些高权限的函数设置权限控制，使得该函数只能被固定地址的调用者调用，从而实现访问权限控制。
- 用户 ：普通用户，参与链上业务场景。用户可持有不同节点颁发的证书，用以向不同的节点发起交易。具体用户在对应业务场景中的权限，由上层业务系统自己定义。后续平台可抽象出一系列通用的权限管理接口，供业务层更好地进行权限管理。

联盟自治CAF
----------

在实际工程实践过程中，区块链多中心及不可篡改等特性会带来许多使用限制。众所周知，没有任何一个系统是没有漏洞的，也没有任何一个系统在设计之初就能确定全部需求，这种工程上的迭代更新与区块链特性间存在明显的矛盾和冲突，而解决冲突需要强有力的决策，但现有区块链系统缺乏很好的治理机制来做出合理民主的决策。

为了解决区块链多中心、不可篡改等特性与现实工程实践之间的矛盾，平台提出了一种能有效促进区块链自我改进的联盟自治框架CAF（Consortium Autonomous Framework）。

|image0|

平台在联盟链网络中创建了一个“联盟自治成员组织”，所有参与投票的共识节点都是该组织的成员，他们会参与提案从创建到执行的整个流程，具体如下：

1. 影响联盟链链级状态的行为，会被申请人以提案形式提交给该组织；
2. 所有组织成员根据自身制定的投票策略对每个提案作出判断；
3. 当组织中绝大多数成员同意该提案后，提案被通过；
4. 所有链上节点根据通过提案的内容自动变更节点状态。

其中，提案的提出、表决、通过等核心逻辑都依托于智能合约实现。由于智能合约在不同节点间的状态由平台的共识算法保证，能保持时刻同步且严格一致，因此借助智能合约为载体，可以高效实现提案事件的分发以及投票结果的聚合。

目前，CAF可用于成员管理、系统升级以及合约升级三大应用场景：

- 多中心化的成员管理：现有联盟链系统的成员变更往往与身份认证强绑定，而身份认证一般都是由第三方CA授权认证，成为多中心区块链系统中的唯一强中心。这种方式一方面存在单点故障风险，另一方面会大大降低整体区块链系统的安全可信度。CAF利用智能合约充当成员变更提案的协商平台，通过节点自颁发数字证书作为协商结果凭证（详见3.1.2.2章节 分布式CA认证体系），使成员变更流程具有多中心化的特点，同时整个协商过程也公开透明。
- 基于自治的系统升级：系统升级分为公有链硬分叉式的非兼容性升级，以及联盟链线下手动兼容性升级。后者往往需要漫长的线下商务协商，而且通常是运维人员手动完成升级，效率低下。基于CAF，组织成员可在需要时发起系统升级提案，决议通过后节点会自动从互联网拉取最新的二进制配置文件完成系统升级，具有高效、同步、自动化的特点。
-	基于自治的合约升级：传统的合约升级方式只能由合约部署者发起合约升级交易完成，这种方式一方面存在单点故障风险，导致合约无法升级，另一方面合约部署者可能在没征得其余参与方同意的情况下，单方面进行合约升级。基于CAF，组织成员可事先指定升级策略写入智能合约，在需要升级时发起提案，借助权限受控的合约自升级指令，解决区块链合约的升级问题。

安全审计服务
-----------

随着区块链商业应用的步伐加快，如何通过有效审计来保障链上数据的安全以及业务运行的合法合规性是区块链行业发展需要重点关注的问题。央行于今年发布了《金融分布式账本技术安全规范》和《区块链技术金融应用评估规则》，被业内视为区块链在金融行业内应用的重要标准，两份标准都对区块链系统的安全审计提出了明确要求。

平台推出的安全审计服务，完全符合上述标准要求，通过审计数据的自动化采集与分析系统，支持审计方对节点共识历史、账本数据同步和变更事件、系统运行日志、用户访问操作记录、用户身份变更记录、审计管理员操作记录以及业务数据本身内容等展开精确有效的审计工作，同时建立实时风险告警机制，对系统异常情况作出告警，并支持事故还原追责，全方位保障上链数据的安全性以及业务运行的合规性

|image1|

平台现已适配GaryLog和ELK两种常用日志分析系统，支持审计数据的自定义可视化展示，用户可根据实际需求进行选择。


.. |image0| image:: ../../images/governonce1.png
.. |image1| image:: ../../images/governonce2.png
